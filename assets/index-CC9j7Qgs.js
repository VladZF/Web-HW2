(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}})();const k=document.querySelector("#pokemon-grid"),q=document.querySelector("#loading-initial"),v=document.querySelector("#loading-more"),w=document.querySelector("#theme-toggle-button"),f=document.querySelector("#pokemon-modal"),g=f.querySelector("#modal-pokemon-details"),j=f.querySelectorAll("[data-close-modal]"),T=document.body,C=document.querySelector("#search-input"),L=document.querySelector("#no-results-message"),$=document.querySelector("#infinite-scroll-trigger"),K="https://pokeapi.co/api/v2/",W=5e3,R=30,V="/public/question-mark.svg";let a=!1,p=[],d=[],h=0,u=!1,S=!1,A="",i=!0,E=new Map,c;function b(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}function J(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>{e.apply(this,o)},t)}}async function x(e){try{const t=await fetch(e);if(!t.ok){const n=await t.text();throw console.error(`HTTP error! Status: ${t.status}, URL: ${e}, Body: ${n}`),new Error(`Network response was not ok: ${t.statusText} (status: ${t.status})`)}return t.headers.get("content-length")==="0"?null:await t.json()}catch(t){return console.error(`Fetch error for ${e}:`,t),null}}async function Q(){const e=`${K}pokemon?limit=${W}&offset=0`;console.log(`Fetching initial list: ${e}`);const t=await x(e);t&&t.results?(p=t.results,d=p,i=p.length>0,console.log(`Fetched ${p.length} Pok√©mon names/URLs.`)):(displayGridError("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–∏—Å–æ–∫ –ø–æ–∫–µ–º–æ–Ω–æ–≤."),p=[],d=[],i=!1)}async function X(e){const t=e.map(async o=>{if(E.has(o.url)){const l=E.get(o.url);return{name:l.name,url:o.url,sprites:l.sprites}}const s=await x(o.url);return s?(E.set(o.url,s),{name:s.name,url:o.url,sprites:s.sprites}):(console.warn(`Failed to fetch details for ${o.name||o.url}`),null)});return(await Promise.allSettled(t)).filter(o=>o.status==="fulfilled"&&o.value).map(o=>o.value)}function Y(e){var l;const t=document.createElement("div");t.classList.add("pokemon-tile"),t.dataset.url=e.url,t.setAttribute("role","button"),t.setAttribute("tabindex","0");const n=b(e.name),o=(l=e.sprites)==null?void 0:l.front_default;if(o){const r=document.createElement("img");r.src=o,r.alt=n,r.width=80,r.height=80,r.loading="lazy",r.onerror=P=>{console.warn(`Sprite failed to load for ${n}: ${o}`);const y=document.createElement("div");y.classList.add("placeholder-sprite"),y.textContent="?",y.setAttribute("aria-label","–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ"),P.target.parentNode===t&&t.replaceChild(y,P.target)},t.appendChild(r)}else{const r=document.createElement("div");r.classList.add("placeholder-sprite"),r.textContent="?",r.setAttribute("aria-label","–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ"),t.appendChild(r)}const s=document.createElement("span");return s.textContent=n,t.appendChild(s),t.addEventListener("click",B),t.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),B(r))}),t}function Z(e){if(!e||e.length===0)return;const t=document.createDocumentFragment();e.forEach(n=>{if(n&&n.name&&n.url){const o=Y(n);t.appendChild(o)}else console.warn("Invalid pokemonData encountered in appendPokemonTiles:",n)}),t.children.length>0&&(k.appendChild(t),L.style.display="none")}function O(e,t=!1){q.style.display="none",v.style.display="none",k.innerHTML="",L.textContent=e,L.style.color=t?"var(--accent-color)":"var(--text-color)",L.style.display="block"}async function I(){if(u||!i){console.log(`Load skipped: isLoading=${u}, hasMorePokemon=${i}`);return}u=!0,v.style.display="flex";const e=d.slice(h,h+R);if(console.log(`Loading batch: offset=${h}, size=${e.length}, activeListSize=${d.length}`),e.length===0){if(i=!1,v.style.display="none",u=!1,k.children.length===0){const n=S?`–ü–æ–∫–µ–º–æ–Ω—ã –ø–æ –∑–∞–ø—Ä–æ—Å—É "${A}" –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.`:"–ù–µ—Ç –ø–æ–∫–µ–º–æ–Ω–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.";O(n)}console.log("No more Pok√©mon to load from active list.");return}const t=await X(e);Z(t),h+=e.length,i=h<d.length,v.style.display="none",u=!1,i||console.log("Reached the end of the active Pok√©mon list.")}function ee(){const e={root:null,rootMargin:"100px",threshold:0};c=new IntersectionObserver(t=>{t[0].isIntersecting&&i&&!u&&(console.log("Intersection observer triggered: Loading more Pok√©mon..."),I())},e),c.observe($)}function te(e){if(S&&A===e)return;console.log(`Starting search for: "${e}"`),S=!0,A=e,u=!1,k.innerHTML="",L.style.display="none",v.style.display="none",d=p.filter(n=>n.name.toLowerCase().includes(e)),h=0,i=d.length>0,console.log(`Filtered list size: ${d.length}`),i?(I(),c&&c.observe($)):(O(`–ü–æ–∫–µ–º–æ–Ω—ã –ø–æ –∑–∞–ø—Ä–æ—Å—É "${e}" –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.`),c&&c.unobserve($))}function ne(){!S&&C.value===""||(console.log("Clearing search results."),S=!1,A="",C.value="",u=!1,k.innerHTML="",L.style.display="none",v.style.display="none",d=p,h=0,i=d.length>0,i?(I(),c&&c.observe($)):(O("–ù–µ—Ç –ø–æ–∫–µ–º–æ–Ω–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è."),c&&c.unobserve($)))}const oe=J(e=>{e===""?ne():te(e)},350);function se(){requestAnimationFrame(()=>{const e=C.value.trim().toLowerCase();oe(e)})}function N(){T.style.overflow="hidden",f.classList.add("active"),f.setAttribute("aria-hidden","false"),g.addEventListener("transitionend",()=>{var e;(e=f.querySelector(".modal-close-btn"))==null||e.focus()},{once:!0})}function z(){T.style.overflow="",f.classList.remove("active"),f.setAttribute("aria-hidden","true"),g.addEventListener("transitionend",_,{once:!0})}function _(){g.innerHTML=`
        <div class="loading-indicator modal-loading">
            <div class="spinner"></div>
            <span>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª–µ–π...</span>
        </div>`,g.removeEventListener("transitionend",_)}function D(e){g.innerHTML=`<p class="error-message" style="padding: 2rem; text-align: center; color: var(--accent-color);">${e}</p>`}function re(){requestAnimationFrame(()=>{g.querySelectorAll(".stat-bar-inner").forEach(t=>{const n=t.getAttribute("data-stat-value");if(n){const s=Math.min(parseInt(n,10)/200*100,100);t.style.width=`${s}%`}else t.style.width="0%"})})}function le(e){var F,H;if(!e){D("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –ø–æ–∫–µ–º–æ–Ω–∞.");return}const{name:t,sprites:n,types:o,height:s,weight:l,stats:r}=e,P=((H=(F=n==null?void 0:n.other)==null?void 0:F["official-artwork"])==null?void 0:H.front_default)||(n==null?void 0:n.front_default)||V,y=(o==null?void 0:o.map(M=>b(M.type.name)).join(", "))||"–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω",G=(r==null?void 0:r.map(M=>{let m=M.stat.name.replace("-"," ");m==="special attack"&&(m="Sp. Attack"),m==="special defense"&&(m="Sp. Defense"),m=b(m);const U=M.base_stat;return`
            <li>
                <span class="stat-name">${m}</span>
                <div class="stat-bar"><div class="stat-bar-inner" data-stat-value="${U}" style="width: 0%;"></div></div>
                <strong class="stat-value">${U}</strong>
            </li>`}).join(""))||"<li>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</li>";g.innerHTML=`
        <h3>${b(t)}</h3>
        <img src="${P}" alt="${b(t)}" width="140" height="140" loading="lazy">
        <div class="pokemon-meta">
            <p><strong>–¢–∏–ø(—ã):</strong> ${y}</p>
            <p><strong>–†–æ—Å—Ç:</strong> ${s?s/10+" –º":"–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"}</p>
            <p><strong>–í–µ—Å:</strong> ${l?l/10+" –∫–≥":"–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"}</p>
        </div>
        <h4>–ë–∞–∑–æ–≤—ã–µ —Å—Ç–∞—Ç—ã:</h4>
        <ul class="stats-list">${G}</ul>`,re()}async function B(e){const t=e.currentTarget,n=t.dataset.url;if(!n){console.error("Missing data-url attribute on Pok√©mon tile:",t),D("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å URL –ø–æ–∫–µ–º–æ–Ω–∞."),N();return}_(),N();let o=E.get(n);o?console.log(`Cache hit for ${n}`):(console.log(`Cache miss for ${n}, fetching full details...`),o=await x(n),o&&E.set(n,o)),le(o)}function ie(){a=!a,T.classList.toggle("dark-theme",a),localStorage.setItem("theme",a?"dark":"light"),w.textContent=a?"üåô":"‚òÄÔ∏è",w.setAttribute("aria-label",a?"–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É":"–í–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É")}function ae(){var n;const e=localStorage.getItem("theme"),t=(n=window.matchMedia)==null?void 0:n.call(window,"(prefers-color-scheme: dark)").matches;a=e==="dark"||!e&&t,T.classList.toggle("dark-theme",a),w.textContent=a?"üåô":"‚òÄÔ∏è",w.setAttribute("aria-label",a?"–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É":"–í–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É")}async function ce(){q.style.display="flex",ae(),w.addEventListener("click",ie),j.forEach(e=>e.addEventListener("click",z)),window.addEventListener("keydown",e=>{e.key==="Escape"&&f.classList.contains("active")&&z()}),C.addEventListener("input",se),await Q(),q.style.display="none",i?(I(),ee()):console.error("Initialization complete, but no Pok√©mon could be loaded initially.")}ce();
